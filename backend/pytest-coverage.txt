============================= test session starts ==============================
platform linux -- Python 3.13.5, pytest-8.4.1, pluggy-1.6.0 -- /opt/hostedtoolcache/Python/3.13.5/x64/bin/python
cachedir: .pytest_cache
rootdir: /home/runner/work/travelstyle/travelstyle/backend
configfile: pytest.ini
plugins: cov-6.2.1, asyncio-1.1.0, xdist-3.8.0, anyio-4.9.0, mock-3.14.1
asyncio: mode=Mode.STRICT, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 279 items

tests/test_auth.py::TestAuthRegistrationAndLogin::test_register_success PASSED [  0%]
tests/test_auth.py::TestAuthRegistrationAndLogin::test_register_invalid_email PASSED [  0%]
tests/test_auth.py::TestAuthRegistrationAndLogin::test_register_short_password PASSED [  1%]
tests/test_auth.py::TestAuthRegistrationAndLogin::test_register_service_error PASSED [  1%]
tests/test_auth.py::TestAuthRegistrationAndLogin::test_register_service_exception PASSED [  1%]
tests/test_auth.py::TestAuthRegistrationAndLogin::test_login_success PASSED [  2%]
tests/test_auth.py::TestAuthRegistrationAndLogin::test_login_invalid_credentials PASSED [  2%]
tests/test_auth.py::TestAuthRegistrationAndLogin::test_login_invalid_email PASSED [  2%]
tests/test_auth.py::TestAuthRegistrationAndLogin::test_login_service_exception PASSED [  3%]
tests/test_auth.py::TestAuthOtherEndpoints::test_logout_success PASSED   [  3%]
tests/test_auth.py::TestAuthOtherEndpoints::test_logout_without_token PASSED [  3%]
tests/test_auth.py::TestAuthOtherEndpoints::test_logout_unauthorized PASSED [  4%]
tests/test_auth.py::TestAuthOtherEndpoints::test_logout_service_exception PASSED [  4%]
tests/test_auth.py::TestAuthOtherEndpoints::test_forgot_password_success PASSED [  5%]
tests/test_auth.py::TestAuthOtherEndpoints::test_forgot_password_invalid_email PASSED [  5%]
tests/test_auth.py::TestAuthOtherEndpoints::test_forgot_password_service_exception PASSED [  5%]
tests/test_auth.py::TestAuthOtherEndpoints::test_reset_password_success PASSED [  6%]
tests/test_auth.py::TestAuthOtherEndpoints::test_reset_password_invalid_token PASSED [  6%]
tests/test_auth.py::TestAuthOtherEndpoints::test_reset_password_short_password PASSED [  6%]
tests/test_auth.py::TestAuthOtherEndpoints::test_reset_password_service_exception PASSED [  7%]
tests/test_auth.py::TestAuthOtherEndpoints::test_refresh_token_success PASSED [  7%]
tests/test_auth.py::TestAuthOtherEndpoints::test_refresh_token_invalid PASSED [  7%]
tests/test_auth.py::TestAuthOtherEndpoints::test_refresh_token_service_exception PASSED [  8%]
tests/test_auth.py::TestAuthOtherEndpoints::test_get_current_user_profile_success PASSED [  8%]
tests/test_auth.py::TestAuthOtherEndpoints::test_get_current_user_profile_not_found PASSED [  8%]
tests/test_auth.py::TestAuthOtherEndpoints::test_get_current_user_profile_unauthorized PASSED [  9%]
tests/test_auth.py::TestAuthOtherEndpoints::test_get_current_user_profile_service_exception PASSED [  9%]
tests/test_auth.py::TestAuthOtherEndpoints::test_update_current_user_profile_success PASSED [ 10%]
tests/test_auth.py::TestAuthOtherEndpoints::test_update_current_user_profile_no_valid_fields PASSED [ 10%]
tests/test_auth.py::TestAuthOtherEndpoints::test_update_current_user_profile_not_found PASSED [ 10%]
tests/test_auth.py::TestAuthOtherEndpoints::test_update_current_user_profile_unauthorized PASSED [ 11%]
tests/test_auth.py::TestAuthOtherEndpoints::test_update_current_user_profile_service_exception PASSED [ 11%]
tests/test_auth.py::TestAuthOtherEndpoints::test_update_current_user_preferences_success PASSED [ 11%]
tests/test_auth.py::TestAuthOtherEndpoints::test_update_current_user_preferences_no_valid_fields PASSED [ 12%]
tests/test_auth.py::TestAuthOtherEndpoints::test_update_current_user_preferences_unauthorized PASSED [ 12%]
tests/test_auth.py::TestAuthOtherEndpoints::test_update_current_user_preferences_service_failure PASSED [ 12%]
tests/test_auth.py::TestAuthOtherEndpoints::test_update_current_user_preferences_service_exception PASSED [ 13%]
tests/test_auth_service.py::test_login_success PASSED                    [ 13%]
tests/test_auth_service.py::test_login_invalid_credentials PASSED        [ 13%]
tests/test_auth_service.py::test_login_no_session PASSED                 [ 14%]
tests/test_auth_service.py::test_login_exception PASSED                  [ 14%]
tests/test_auth_service.py::test_logout_success PASSED                   [ 15%]
tests/test_auth_service.py::test_logout_with_refresh_token PASSED        [ 15%]
tests/test_auth_service.py::test_logout_exception PASSED                 [ 15%]
tests/test_auth_service.py::test_forgot_password_success PASSED          [ 16%]
tests/test_auth_service.py::test_forgot_password_exception_original PASSED [ 16%]
tests/test_auth_service.py::test_reset_password_success PASSED           [ 16%]
tests/test_auth_service.py::test_reset_password_exception_original PASSED [ 17%]
tests/test_auth_service.py::test_refresh_token_success PASSED            [ 17%]
tests/test_auth_service.py::test_refresh_token_no_session_original PASSED [ 17%]
tests/test_auth_service.py::test_register_success PASSED                 [ 18%]
tests/test_auth_service.py::test_register_no_session PASSED              [ 18%]
tests/test_auth_service.py::test_get_user_profile_success PASSED         [ 18%]
tests/test_auth_service.py::test_update_user_profile_success PASSED      [ 19%]
tests/test_auth_service.py::test_update_user_profile_sync_success PASSED [ 19%]
tests/test_auth_service.py::test_update_user_profile_sync_no_user PASSED [ 20%]
tests/test_auth_service.py::test_update_user_preferences_success PASSED  [ 20%]
tests/test_auth_service.py::test_auth_service_init_client_failure PASSED [ 20%]
tests/test_auth_service.py::test_login_no_user_profile PASSED            [ 21%]
tests/test_auth_service.py::test_logout_with_refresh_token_exception PASSED [ 21%]
tests/test_auth_service.py::test_logout_without_refresh_token_exception PASSED [ 21%]
tests/test_auth_service.py::test_forgot_password_exception PASSED        [ 22%]
tests/test_auth_service.py::test_reset_password_exception PASSED         [ 22%]
tests/test_auth_service.py::test_refresh_token_no_session PASSED         [ 22%]
tests/test_auth_service.py::test_refresh_token_exception PASSED          [ 23%]
tests/test_auth_service.py::test_register_no_user PASSED                 [ 23%]
tests/test_auth_service.py::test_register_no_session_after_login PASSED  [ 24%]
tests/test_auth_service.py::test_register_exception PASSED               [ 24%]
tests/test_auth_service.py::test_get_user_profile_no_user PASSED         [ 24%]
tests/test_auth_service.py::test_get_user_profile_exception PASSED       [ 25%]
tests/test_auth_service.py::test_update_user_profile_no_user PASSED      [ 25%]
tests/test_auth_service.py::test_update_user_profile_exception PASSED    [ 25%]
tests/test_auth_service.py::test_update_user_profile_sync_no_auth_user PASSED [ 26%]
tests/test_auth_service.py::test_update_user_profile_sync_with_style_preferences PASSED [ 26%]
tests/test_auth_service.py::test_update_user_profile_sync_exception PASSED [ 26%]
tests/test_auth_service.py::test_update_user_preferences_exception PASSED [ 27%]
tests/test_auth_service.py::test_auth_service_no_client PASSED           [ 27%]
tests/test_chat.py::TestChatEndpoints::test_chat_endpoint_success PASSED [ 27%]
tests/test_chat.py::TestChatEndpoints::test_chat_endpoint_no_auth PASSED [ 28%]
tests/test_chat.py::TestChatEndpoints::test_chat_endpoint_invalid_request PASSED [ 28%]
tests/test_chat.py::TestChatEndpoints::test_chat_endpoint_orchestrator_error PASSED [ 29%]
tests/test_chat.py::TestChatEndpoints::test_get_conversation_history_success PASSED [ 29%]
tests/test_chat.py::TestChatEndpoints::test_get_conversation_history_no_auth PASSED [ 29%]
tests/test_chat.py::TestChatEndpoints::test_get_conversation_history_error PASSED [ 30%]
tests/test_chat.py::TestChatEndpoints::test_chat_endpoint_database_error PASSED [ 30%]
tests/test_chat.py::TestChatEndpoints::test_chat_endpoint_user_profile_error PASSED [ 30%]
tests/test_chat.py::test_generate_response_success PASSED                [ 31%]
tests/test_chat.py::test_generate_response_error PASSED                  [ 31%]
tests/test_chat.py::test_build_system_prompt PASSED                      [ 31%]
tests/test_chat.py::test_build_context_prompt PASSED                     [ 32%]
tests/test_chat.py::test_process_response PASSED                         [ 32%]
tests/test_currency_service.py::test_get_exchange_rates_json_parse_error PASSED [ 32%]
tests/test_currency_service.py::test_get_exchange_rates_json_parse_exception PASSED [ 33%]
tests/test_currency_service.py::test_get_exchange_rates_non_dict_response PASSED [ 33%]
tests/test_currency_service.py::test_get_exchange_rates_http_status_error PASSED [ 34%]
tests/test_currency_service.py::test_get_exchange_rates_timeout_error PASSED [ 34%]
tests/test_currency_service.py::test_get_exchange_rates_value_error PASSED [ 34%]
tests/test_currency_service.py::test_get_exchange_rates_currency_normalization PASSED [ 35%]
tests/test_currency_service.py::test_get_pair_exchange_rate_json_parse_error PASSED [ 35%]
tests/test_currency_service.py::test_get_pair_exchange_rate_json_parse_exception PASSED [ 35%]
tests/test_currency_service.py::test_get_pair_exchange_rate_non_success_result PASSED [ 36%]
tests/test_currency_service.py::test_get_pair_exchange_rate_non_dict_response PASSED [ 36%]
tests/test_currency_service.py::test_get_pair_exchange_rate_currency_normalization PASSED [ 36%]
tests/test_currency_service.py::test_get_pair_exchange_rate_http_error PASSED [ 37%]
tests/test_currency_service.py::test_get_pair_exchange_rate_request_error PASSED [ 37%]
tests/test_currency_service.py::test_get_pair_exchange_rate_generic_exception PASSED [ 37%]
tests/test_currency_service.py::test_convert_currency_with_get_pair_exchange_rate_failure PASSED [ 38%]
tests/test_currency_service.py::test_convert_currency_amount_rounding PASSED [ 38%]
tests/test_currency_service.py::test_convert_currency_zero_amount PASSED [ 39%]
tests/test_currency_service.py::test_convert_currency_negative_amount PASSED [ 39%]
tests/test_currency_service.py::test_currency_service_initialization PASSED [ 39%]
tests/test_deps.py::test_get_current_user_valid_token PASSED             [ 40%]
tests/test_deps.py::test_get_current_user_invalid_token PASSED           [ 40%]
tests/test_deps.py::test_get_current_user_exception PASSED               [ 40%]
tests/test_deps.py::test_get_current_user_missing_credentials PASSED     [ 41%]
tests/test_deps.py::test_get_current_active_user_active PASSED           [ 41%]
tests/test_deps.py::test_get_current_active_user_inactive PASSED         [ 41%]
tests/test_deps.py::test_get_current_active_user_missing_is_active PASSED [ 42%]
tests/test_deps.py::test_get_current_active_user_none_is_active PASSED   [ 42%]
tests/test_deps.py::test_get_current_user_empty_credentials PASSED       [ 43%]
tests/test_deps.py::test_get_current_user_none_credentials PASSED        [ 43%]
tests/test_main.py::test_root PASSED                                     [ 43%]
tests/test_main.py::test_health PASSED                                   [ 44%]
tests/test_main.py::test_docs PASSED                                     [ 44%]
tests/test_main.py::test_openapi PASSED                                  [ 44%]
tests/test_main.py::test_redoc PASSED                                    [ 45%]
tests/test_rate_limiter.py::test_rate_limit_first_call PASSED            [ 45%]
tests/test_rate_limiter.py::test_rate_limit_within_limit PASSED          [ 45%]
tests/test_rate_limiter.py::test_rate_limit_exceeded PASSED              [ 46%]
tests/test_rate_limiter.py::test_rate_limit_reset_after_period PASSED    [ 46%]
tests/test_rate_limiter.py::test_rate_limit_with_jwt_token PASSED        [ 46%]
tests/test_rate_limiter.py::test_rate_limit_jwt_decode_failure PASSED    [ 47%]
tests/test_rate_limiter.py::test_rate_limit_no_request_object PASSED     [ 47%]
tests/test_rate_limiter.py::test_rate_limit_request_without_client PASSED [ 48%]
tests/test_rate_limiter.py::test_cleanup_old_entries PASSED              [ 48%]
tests/test_rate_limiter.py::test_cleanup_old_entries_no_cleanup_needed PASSED [ 48%]
tests/test_rate_limiter.py::test_rate_limit_cleanup_threshold PASSED     [ 49%]
tests/test_rate_limiter.py::test_rate_limit_jwt_missing_sub PASSED       [ 49%]
tests/test_rate_limiter.py::test_rate_limit_jwt_value_error PASSED       [ 49%]
tests/test_rate_limiter.py::test_rate_limit_jwt_key_error PASSED         [ 50%]
tests/test_recommendations.py::TestRecommendationsEndpoints::test_cultural_insights_success PASSED [ 50%]
tests/test_recommendations.py::TestRecommendationsEndpoints::test_cultural_insights_not_found PASSED [ 50%]
tests/test_recommendations.py::TestRecommendationsEndpoints::test_cultural_insights_service_exception PASSED [ 51%]
tests/test_recommendations.py::TestRecommendationsEndpoints::test_weather_forecast_success PASSED [ 51%]
tests/test_recommendations.py::TestRecommendationsEndpoints::test_weather_forecast_not_found PASSED [ 51%]
tests/test_recommendations.py::TestRecommendationsEndpoints::test_weather_forecast_service_exception PASSED [ 52%]
tests/test_recommendations.py::TestRecommendationsEndpoints::test_exchange_rates_success PASSED [ 52%]
tests/test_recommendations.py::TestRecommendationsEndpoints::test_exchange_rates_not_found PASSED [ 53%]
tests/test_recommendations.py::TestRecommendationsEndpoints::test_exchange_rates_service_exception PASSED [ 53%]
tests/test_recommendations.py::TestRecommendationsEndpoints::test_currency_conversion_success PASSED [ 53%]
tests/test_recommendations.py::TestRecommendationsEndpoints::test_currency_conversion_failure PASSED [ 54%]
tests/test_recommendations.py::TestRecommendationsEndpoints::test_currency_conversion_service_exception PASSED [ 54%]
tests/test_recommendations.py::TestRecommendationsEndpoints::test_recommendations_no_auth PASSED [ 54%]
tests/test_recommendations.py::test_get_exchange_rates_success PASSED    [ 55%]
tests/test_recommendations.py::test_get_exchange_rates_cache PASSED      [ 55%]
tests/test_recommendations.py::test_get_exchange_rates_error PASSED      [ 55%]
tests/test_recommendations.py::test_get_pair_exchange_rate_success PASSED [ 56%]
tests/test_recommendations.py::test_get_pair_exchange_rate_error PASSED  [ 56%]
tests/test_recommendations.py::test_get_pair_exchange_rate_endpoint_success PASSED [ 56%]
tests/test_recommendations.py::test_get_pair_exchange_rate_endpoint_not_found PASSED [ 57%]
tests/test_recommendations.py::test_get_pair_exchange_rate_endpoint_service_exception PASSED [ 57%]
tests/test_recommendations.py::test_convert_currency_success PASSED      [ 58%]
tests/test_recommendations.py::test_convert_currency_error PASSED        [ 58%]
tests/test_recommendations.py::test_generate_travel_recommendations_success PASSED [ 58%]
tests/test_recommendations.py::test_generate_travel_recommendations_error PASSED [ 59%]
tests/test_recommendations.py::test_parse_trip_context PASSED            [ 59%]
tests/test_recommendations.py::test_enhance_response PASSED              [ 59%]
tests/test_recommendations.py::test_get_cultural_insights_success PASSED [ 60%]
tests/test_recommendations.py::test_get_cultural_insights_cache PASSED   [ 60%]
tests/test_recommendations.py::test_get_cultural_insights_error PASSED   [ 60%]
tests/test_recommendations.py::test_get_style_recommendations_success PASSED [ 61%]
tests/test_recommendations.py::test_get_style_recommendations_error PASSED [ 61%]
tests/test_recommendations.py::test_process_cultural_data PASSED         [ 62%]
tests/test_recommendations.py::test_process_style_data PASSED            [ 62%]
tests/test_recommendations.py::test_get_fallback_cultural_data PASSED    [ 62%]
tests/test_recommendations.py::test_get_fallback_style_data PASSED       [ 63%]
tests/test_recommendations.py::test_generate_travel_recommendations_orchestration_error PASSED [ 63%]
tests/test_recommendations.py::test_safe_api_call_exception PASSED       [ 63%]
tests/test_recommendations.py::test_parse_trip_context_destination_extraction PASSED [ 64%]
tests/test_recommendations.py::test_parse_trip_context_destination_extraction_visiting PASSED [ 64%]
tests/test_recommendations.py::test_parse_trip_context_destination_extraction_in PASSED [ 64%]
tests/test_recommendations.py::test_parse_trip_context_business_context PASSED [ 65%]
tests/test_recommendations.py::test_parse_trip_context_formal_context PASSED [ 65%]
tests/test_recommendations.py::test_parse_trip_context_active_context PASSED [ 65%]
tests/test_recommendations.py::test_enhance_response_with_all_context PASSED [ 66%]
tests/test_recommendations.py::test_enhance_response_with_partial_context PASSED [ 66%]
tests/test_recommendations.py::test_enhance_response_with_no_destination PASSED [ 67%]
tests/test_recommendations.py::test_generate_travel_recommendations_no_destination PASSED [ 67%]
tests/test_recommendations.py::test_generate_travel_recommendations_no_user_profile PASSED [ 67%]
tests/test_security.py::test_verify_jwt_token_valid PASSED               [ 68%]
tests/test_security.py::test_verify_jwt_token_missing_user_id PASSED     [ 68%]
tests/test_security.py::test_verify_jwt_token_jwt_error PASSED           [ 68%]
tests/test_security.py::test_verify_jwt_token_value_error PASSED         [ 69%]
tests/test_security.py::test_verify_jwt_token_key_error PASSED           [ 69%]
tests/test_security.py::test_get_user_by_id_success PASSED               [ 69%]
tests/test_security.py::test_get_user_by_id_no_user PASSED               [ 70%]
tests/test_security.py::test_get_user_by_id_value_error PASSED           [ 70%]
tests/test_security.py::test_get_user_by_id_key_error PASSED             [ 70%]
tests/test_security.py::test_get_user_by_id_attribute_error PASSED       [ 71%]
tests/test_security.py::test_revoke_token_success PASSED                 [ 71%]
tests/test_security.py::test_revoke_token_value_error PASSED             [ 72%]
tests/test_security.py::test_create_access_token PASSED                  [ 72%]
tests/test_security.py::test_verify_token_wrapper PASSED                 [ 72%]
tests/test_security.py::test_verify_token_wrapper_none PASSED            [ 73%]
tests/test_security.py::test_verify_jwt_token_with_default_is_active PASSED [ 73%]
tests/test_security.py::test_verify_jwt_token_with_false_is_active PASSED [ 73%]
tests/test_supabase_cache.py::test_get_weather_cache_success PASSED      [ 74%]
tests/test_supabase_cache.py::test_get_weather_cache_expired PASSED      [ 74%]
tests/test_supabase_cache.py::test_get_weather_cache_not_found PASSED    [ 74%]
tests/test_supabase_cache.py::test_set_weather_cache_success PASSED      [ 75%]
tests/test_supabase_cache.py::test_set_weather_cache_error PASSED        [ 75%]
tests/test_supabase_cache.py::test_get_cultural_cache_success PASSED     [ 75%]
tests/test_supabase_cache.py::test_get_cultural_cache_expired PASSED     [ 76%]
tests/test_supabase_cache.py::test_set_cultural_cache_success PASSED     [ 76%]
tests/test_supabase_cache.py::test_get_currency_cache_success PASSED     [ 77%]
tests/test_supabase_cache.py::test_get_currency_cache_empty PASSED       [ 77%]
tests/test_supabase_cache.py::test_set_currency_cache_success PASSED     [ 77%]
tests/test_supabase_cache.py::test_is_expired_future PASSED              [ 78%]
tests/test_supabase_cache.py::test_is_expired_past PASSED                [ 78%]
tests/test_supabase_cache.py::test_is_expired_invalid_format PASSED      [ 78%]
tests/test_supabase_cache.py::test_is_expired_with_z_suffix PASSED       [ 79%]
tests/test_supabase_cache.py::test_get_weather_cache_no_expires_at PASSED [ 79%]
tests/test_supabase_cache.py::test_get_cultural_cache_error PASSED       [ 79%]
tests/test_supabase_cache.py::test_set_cultural_cache_error PASSED       [ 80%]
tests/test_supabase_cache.py::test_get_currency_cache_error PASSED       [ 80%]
tests/test_supabase_cache.py::test_set_currency_cache_error PASSED       [ 81%]
tests/test_user.py::TestUserEndpoints::test_get_current_user_profile_success PASSED [ 81%]
tests/test_user.py::TestUserEndpoints::test_get_current_user_profile_error PASSED [ 81%]
tests/test_user.py::TestUserEndpoints::test_get_user_preferences_success PASSED [ 82%]
tests/test_user.py::TestUserEndpoints::test_get_user_preferences_error PASSED [ 82%]
tests/test_user.py::TestUserEndpoints::test_update_user_preferences_success PASSED [ 82%]
tests/test_user.py::TestUserEndpoints::test_update_user_preferences_error PASSED [ 83%]
tests/test_user.py::TestUserEndpoints::test_user_endpoints_no_auth PASSED [ 83%]
tests/test_user.py::TestUserEndpoints::test_update_user_preferences_invalid_data PASSED [ 83%]
tests/test_user.py::test_user_profile_creation PASSED                    [ 84%]
tests/test_user.py::test_user_profile_email_validation PASSED            [ 84%]
tests/test_user.py::test_user_preferences_defaults PASSED                [ 84%]
tests/test_user.py::test_user_auth_token_defaults PASSED                 [ 85%]
tests/test_user.py::test_user_activity_creation PASSED                   [ 85%]
tests/test_user.py::test_user_session_defaults PASSED                    [ 86%]
tests/test_user.py::test_user_feedback_rating_bounds PASSED              [ 86%]
tests/test_user.py::test_user_usage_stats_defaults PASSED                [ 86%]
tests/test_user_api.py::test_get_current_user_profile_success PASSED     [ 87%]
tests/test_user_api.py::test_get_current_user_profile_inactive PASSED    [ 87%]
tests/test_user_api.py::test_get_current_user_profile_minimal PASSED     [ 87%]
tests/test_user_api.py::test_get_current_user_profile_exception PASSED   [ 88%]
tests/test_user_api.py::test_get_user_preferences_success PASSED         [ 88%]
tests/test_user_api.py::test_update_user_preferences_success PASSED      [ 88%]
tests/test_user_api.py::test_update_user_preferences_empty_preferences PASSED [ 89%]
tests/test_user_api.py::test_update_user_preferences_missing_user_id PASSED [ 89%]
tests/test_user_utils.py::test_extract_user_profile_with_dict_metadata PASSED [ 89%]
tests/test_user_utils.py::test_extract_user_profile_with_object_metadata PASSED [ 90%]
tests/test_user_utils.py::test_extract_user_profile_with_no_metadata PASSED [ 90%]
tests/test_user_utils.py::test_extract_user_profile_with_missing_attributes PASSED [ 91%]
tests/test_user_utils.py::test_extract_user_profile_with_none_user PASSED [ 91%]
tests/test_weather_service.py::test_get_weather_data_cache_hit PASSED    [ 91%]
tests/test_weather_service.py::test_get_weather_data_cache_miss_success PASSED [ 92%]
tests/test_weather_service.py::test_get_weather_data_api_error PASSED    [ 92%]
tests/test_weather_service.py::test__get_current_weather_success PASSED  [ 92%]
tests/test_weather_service.py::test__get_current_weather_error PASSED    [ 93%]
tests/test_weather_service.py::test__get_forecast_api_error PASSED       [ 93%]
tests/test_weather_service.py::test__get_forecast_empty_data PASSED      [ 93%]
tests/test_weather_service.py::test__get_forecast_success_with_data PASSED [ 94%]
tests/test_weather_service.py::test__calculate_precipitation_chance PASSED [ 94%]
tests/test_weather_service.py::test__generate_clothing_recommendations_temp_ranges PASSED [ 94%]
tests/test_weather_service.py::test__generate_clothing_recommendations_rain PASSED [ 95%]
tests/test_weather_service.py::test__generate_clothing_recommendations_forecast_precip PASSED [ 95%]
tests/test_weather_service.py::test__generate_clothing_recommendations_wind_humidity PASSED [ 96%]
tests/test_weather_service.py::test__generate_clothing_recommendations_no_current PASSED [ 96%]
tests/test_weather_service.py::test_get_lat_lon_for_city_success PASSED  [ 96%]
tests/test_weather_service.py::test_get_lat_lon_for_city_with_state_country PASSED [ 97%]
tests/test_weather_service.py::test_get_lat_lon_for_city_empty_response PASSED [ 97%]
tests/test_weather_service.py::test_get_lat_lon_for_city_api_error PASSED [ 97%]
tests/test_weather_service.py::test_get_weather_data_geocoding_failure PASSED [ 98%]
tests/test_weather_service.py::test_get_weather_data_current_weather_failure PASSED [ 98%]
tests/test_weather_service.py::test_get_weather_data_service_exception PASSED [ 98%]
tests/test_weather_service.py::test__get_current_weather_api_error PASSED [ 99%]
tests/test_weather_service.py::test__get_current_weather_missing_visibility PASSED [ 99%]
tests/test_weather_service.py::test_get_weather_data_with_state_country PASSED [100%]

=============================== warnings summary ===============================
../../../../../../opt/hostedtoolcache/Python/3.13.5/x64/lib/python3.13/site-packages/pydantic/_internal/_config.py:323
  /opt/hostedtoolcache/Python/3.13.5/x64/lib/python3.13/site-packages/pydantic/_internal/_config.py:323: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
    warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)

tests/test_chat.py: 4 warnings
tests/test_recommendations.py: 9 warnings
  /opt/hostedtoolcache/Python/3.13.5/x64/lib/python3.13/site-packages/pydantic/main.py:253: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
- generated xml file: /home/runner/work/travelstyle/travelstyle/backend/pytest.xml -
================================ tests coverage ================================
_______________ coverage: platform linux, python 3.13.5-final-0 ________________

Name                             Stmts   Miss  Cover   Missing
--------------------------------------------------------------
app/api/v1/auth.py                 117      3    97%   179, 207, 250
app/api/v1/user.py                  27      3    89%   38-40
app/core/security.py                45      3    93%   77-79
app/main.py                         32      4    88%   27-30, 82
app/services/auth_service.py       150      1    99%   162
app/services/openai_service.py      55      1    98%   77
app/services/orchestrator.py        73      2    97%   159-160
app/services/qloo_service.py        55      3    95%   65, 67, 108
app/utils/error_handlers.py          9      1    89%   16
--------------------------------------------------------------
TOTAL                             1322     21    98%

20 files skipped due to complete coverage.
====================== 279 passed, 14 warnings in 39.01s =======================
